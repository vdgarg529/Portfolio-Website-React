# Constructors, Destructors, and Related Concepts in C++

## 1. Detailed Notes

### Constructor
- A **constructor** is a **special member function** of a class that automatically gets called when an object is created.  
- Its name is the **same as the class name** and it has **no return type** (not even void).  

#### Types of Constructors
1. **Default Constructor (Non-Parameterized)**  
   - Takes **no arguments**.  
   - Initializes data members with default values.  

2. **Parameterized Constructor**  
   - Accepts arguments to initialize objects with specific values.  

3. **Copy Constructor**  
   - Creates a new object as a **copy of an existing object**.  
   - Syntax:  
     ```cpp
     ClassName(const ClassName &obj) { ... }
     ```

#### Constructor Overloading
- Multiple constructors with different parameter lists in the same class.  
- Achieved via **function overloading**.

---

### `this` Pointer
- A special pointer **available in all non-static member functions**.  
- It points to the current object
- this->property is same as  (\*this).property
- Refers to the **calling object**.  
- Useful when local variables shadow data members.  

---

### Shallow Copy vs Deep Copy (in Copy Constructors)
1. **Shallow Copy**  
   - Default copy constructor copies only **references (memory addresses)**.  
   - Both objects point to the same memory → risk of unintended modifications or double deletion.  

2. **Deep Copy**  
   - Programmer-defined copy constructor.  
   - Allocates separate memory for copied object and duplicates data.  

#### Problem with Shallow Copy 
- There is no issue in case of static memory allocation, the problem occurs in case of dynamic memory allocations

![[Pasted image 20250911123340.png]]
In this cgpaPtr stores the address of the object.

![[Pasted image 20250911123542.png]]
![[Pasted image 20250911123614.png]]


---
 
### Destructor
- A **special member function** with the same name as the class, but prefixed with `~`.  
- Called **automatically when an object is destroyed**.  
- Used to **release resources (memory, file handles, etc.)**.  
- No parameters, no return type, not overloaded.
- Need to be defined by the programmer in case of dynamic memory allocation

---

## 2. Definition

- **Constructor:** A special method to initialize objects automatically.  
- **Destructor:** A special method to clean up resources before an object is destroyed.  
- **Copy Constructor:** Special constructor to create a new object as a copy of another object.  
- **Shallow Copy:** Copying references, not actual data.  
- **Deep Copy:** Copying both data and allocating new memory.  
- **`this` pointer:** Pointer that holds the address of the current object.  

---

## 3. Key Points to Remember

- Constructor name = Class name.  
- No return type in constructors and destructors. 
- Constructors is only called once (automatically), at object creation
- Memory Allocation happens when constructor is called
- Destructor is called **automatically** when object goes out of scope.  
- If no constructor is defined, compiler provides a **default constructor**.  
- Copy constructors prevent **unintended sharing of memory**.  
- `this` pointer is implicit but can be used explicitly.  

---


---

## 5. C++ Implementation Examples

### Default & Parameterized Constructors
```cpp
#include <iostream>
using namespace std;

class Student {
private:
    string name;
    int age;

public:
    // Default Constructor
    Student() {
        name = "Unknown";
        age = 0;
    }

    // Parameterized Constructor
    Student(string n, int a) {
        name = n;
        age = a;
    }

    void display() {
        cout << "Name: " << name << ", Age: " << age << endl;
    }
};

int main() {
    Student s1;                // Calls default constructor
    Student s2("Alice", 20);   // Calls parameterized constructor

    s1.display();
    s2.display();
    return 0;
}
```


#### Constructor Overloading + this Pointer
```cpp
#include <iostream>
using namespace std;

class Box {
private:
    int length, width, height;

public:
    // Default Constructor
    Box() { this->length = this->width = this->height = 0; }

    // Parameterized Constructor
    Box(int length, int width, int height) {
        this->length = length;
        this->width = width;
        this->height = height;
    }

    void display() {
        cout << "Box dimensions: "
             << length << "x" << width << "x" << height << endl;
    }
};

int main() {
    Box b1;              // default constructor
    Box b2(10, 5, 3);    // parameterized constructor

    b1.display();
    b2.display();
    return 0;
}

```


#### Copy Constructor (Shallow vs Deep Copy)
```cpp
#include <iostream>
#include <cstring>
using namespace std;

class Person {
private:
    char* name;

public:
    // Parameterized constructor
    Person(const char* n) {
        name = new char[strlen(n) + 1];
        strcpy(name, n);
    }

    // Deep Copy Constructor
    Person(const Person& p) {
        name = new char[strlen(p.name) + 1];
        strcpy(name, p.name);
    }

    void display() { cout << "Name: " << name << endl; }

    // Destructor to free memory
    ~Person() { delete[] name; }
};

int main() {
    Person p1("John");
    Person p2 = p1;  // Calls deep copy constructor

    p1.display();
    p2.display();
    return 0;
}

```



#### Destructor Example

```cpp
#include <iostream>
using namespace std;

class File {
public:
    File() { cout << "File opened!" << endl; }
    ~File() { cout << "File closed!" << endl; }
};

int main() {
    File f1; // Constructor called
    // Destructor will be called automatically when f1 goes out of scope
    return 0;
}

```


## 6. Real World Example

- **Constructor:** When you **open a new Word document**, it starts blank (default constructor) or from a template (parameterized constructor).
    
- **Copy Constructor:** Making a **duplicate file** (copy constructor).
    
- **Destructor:** Closing the Word document frees memory.
    
- **this pointer:** Imagine labeling your own file as "This File" to avoid confusion with others.
    
- **Shallow vs Deep Copy:**
    
    - Shallow → Copying only the **shortcut link**.
        
    - Deep → Copying the **actual file**.
        

---

## 7. Questions with Answers

### Theory

1. **Q:** What is a constructor?  
    **A:** A constructor is a special method used to initialize objects automatically when they are created.
    
2. **Q:** What is the difference between default and parameterized constructors?  
    **A:**
    
    - Default constructor takes no arguments.
        
    - Parameterized constructor takes arguments to initialize members.
        
3. **Q:** Can constructors be overloaded?  
    **A:** Yes, multiple constructors can exist with different parameter lists.
    
4. **Q:** What is the purpose of a copy constructor?  
    **A:** To initialize a new object as a copy of an existing object.
    
5. **Q:** Difference between shallow copy and deep copy?  
    **A:**
    
    - Shallow: Copies only references → shared memory.
        
    - Deep: Allocates new memory and copies data → independent objects.
        

---

### Coding

6. **Q:** Create a class `Car` with default and parameterized constructors.
    

```cpp
#include <iostream>
using namespace std;

class Car {
private:
    string brand;
    int year;

public:
    Car() { brand = "Unknown"; year = 0; } // default
    Car(string b, int y) { brand = b; year = y; } // parameterized

    void display() {
        cout << brand << " - " << year << endl;
    }
};

int main() {
    Car c1;
    Car c2("Tesla", 2023);

    c1.display();
    c2.display();
    return 0;
}

```

---

7. **Q:** Demonstrate constructor overloading in a `Rectangle` class.
    

```cpp
#include <iostream>
using namespace std;

class Rectangle {
private:
    int length, width;

public:
    Rectangle() { length = width = 0; }
    Rectangle(int l) { length = width = l; }
    Rectangle(int l, int w) { length = l; width = w; }

    int area() { return length * width; }
};

int main() {
    Rectangle r1, r2(5), r3(5, 10);

    cout << "Area1: " << r1.area() << endl;
    cout << "Area2: " << r2.area() << endl;
    cout << "Area3: " << r3.area() << endl;
    return 0;
}

```

---

8. **Q:** Show how `this` pointer resolves ambiguity in a class.
    

```cpp
#include <iostream>
using namespace std;

class Employee {
private:
    int id;

public:
    Employee(int id) {
        this->id = id; // this->id refers to class member
    }

    void display() {
        cout << "Employee ID: " << id << endl;
    }
};

int main() {
    Employee e1(101);
    e1.display();
    return 0;
}

```

---

9. **Q:** Write a program showing shallow copy problem.
    

```cpp
#include <iostream>
using namespace std;

class Shallow {
public:
    int* data;
    Shallow(int val) { data = new int(val); }
    ~Shallow() { delete data; }
};

int main() {
    Shallow s1(10);
    Shallow s2 = s1; // shallow copy (default)
    // Both objects share same memory -> crash when destructors run
    return 0;
}

```

---

10. **Q:** Fix the above shallow copy with deep copy.
    

```cpp
#include <iostream>
using namespace std;

class Deep {
public:
    int* data;
    Deep(int val) { data = new int(val); }

    // deep copy constructor
    Deep(const Deep& d) {
        data = new int(*d.data);
    }

    ~Deep() { delete data; }
};

int main() {
    Deep d1(10);
    Deep d2 = d1; // deep copy
    return 0;
}

```

---

## 8. Multiple Choice Questions (MCQs)

1. Which function is called when an object goes out of scope?  
    a) Constructor  
    b) Destructor  
    c) Copy constructor  
    d) None  
    **Answer:** b) Destructor
    
2. A constructor has:  
    a) Same name as class, no return type  
    b) Any name, no return type  
    c) Same name as class, return type allowed  
    d) Different name, return type void  
    **Answer:** a) Same name as class, no return type
    
3. Copy constructor is used to:  
    a) Destroy an object  
    b) Assign values after creation  
    c) Initialize an object as a copy of another  
    d) Free memory  
    **Answer:** c) Initialize an object as a copy of another
    
4. Which type of copy shares memory between objects?  
    a) Deep copy  
    b) Shallow copy  
    c) Destructor  
    d) Copy constructor  
    **Answer:** b) Shallow copy
    
5. Which keyword is used to refer to the current object?  
    a) self  
    b) object  
    c) this  
    d) super  
    **Answer:** c) this
    
6. Destructor can:  
    a) Be overloaded  
    b) Have parameters  
    c) Not be overloaded or have parameters  
    d) Return values  
    **Answer:** c) Not be overloaded or have parameters
    
7. If no constructor is provided, compiler provides:  
    a) Destructor only  
    b) Default constructor  
    c) Copy constructor only  
    d) None  
    **Answer:** b) Default constructor
    
8. Which constructor allows values to be passed during object creation?  
    a) Default constructor  
    b) Parameterized constructor  
    c) Copy constructor  
    d) Destructor  
    **Answer:** b) Parameterized constructor
    
9. Shallow copy may cause:  
    a) Memory leak  
    b) Dangling pointer  
    c) Double deletion  
    d) All of the above  
    **Answer:** d) All of the above
    
10. Destructor in C++ is declared with:  
    a) `~ClassName()`  
    b) `ClassName()`  
    c) `delete ClassName()`  
    d) `end ClassName()`  
    **Answer:** a) `~ClassName()`
    

---